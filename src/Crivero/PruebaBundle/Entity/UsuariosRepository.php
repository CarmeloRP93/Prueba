<?php

namespace Crivero\PruebaBundle\Entity;

use Doctrine\ORM\EntityRepository;

/**
 * UsuariosRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class UsuariosRepository extends EntityRepository {

    public function getClientes() {
        return $this->getEntityManager()
                        ->createQueryBuilder()->select('u')
                        ->from('CriveroPruebaBundle:Usuarios', 'u')
                        ->where('u.tipo=2')
                        ->getQuery();
    }

    public function searchClientes($searchQuery) {
        return $this->getEntityManager()
                        ->createQuery("SELECT u FROM CriveroPruebaBundle:Usuarios u WHERE u.tipo = 2"
                                    . "AND (u.username LIKE '%{$searchQuery}%' OR u.nombre LIKE '%{$searchQuery}%') ");
    }

    public function getMonitores() {
        return $this->getEntityManager()
                        ->createQueryBuilder()->select('u')
                        ->from('CriveroPruebaBundle:Usuarios', 'u')
                        ->where('u.tipo=3')
                        ->getQuery();
    }

    public function searchMonitores($searchQuery) {
            return $this->getEntityManager()
                        ->createQuery("SELECT u FROM CriveroPruebaBundle:Usuarios u WHERE u.tipo = 3"
                                    . "AND (u.username LIKE '%{$searchQuery}%' OR u.nombre LIKE '%{$searchQuery}%') ");
    }

    public function recuperarPass($id) {
        return $this->getEntityManager()
                        ->createQuery('SELECT u.password FROM CriveroPruebaBundle:Usuarios u WHERE u.id = :id')
                        ->setParameter('id', $id)
                        ->getResult();
    }

    public function getAdmin() {
        return $this->getEntityManager()
                        ->createQuery('SELECT u FROM CriveroPruebaBundle:Usuarios u WHERE u.tipo=1')
                        ->getResult();
    }
    
    public function getClientesJugadores() {
        return $this->getEntityManager()
                        ->createQuery('SELECT u FROM CriveroPruebaBundle:Usuarios u WHERE u.tipo=2')
                        ->getResult();
    }
    
    public function getNombreCliente($username){
        return $this->getEntityManager()
                        ->createQuery('SELECT u.nombre FROM CriveroPruebaBundle:Usuarios u WHERE u.username = :username')
                        ->setParameter('username', $username)
                        ->getResult();
    }
    
    public function getDirector() {
        return $this->getEntityManager()
                        ->createQuery('SELECT u FROM CriveroPruebaBundle:Usuarios u WHERE u.tipo=4')
                        ->getResult();
    }
}
